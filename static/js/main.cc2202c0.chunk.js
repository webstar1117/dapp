(this.webpackJsonptradingview=this.webpackJsonptradingview||[]).push([[0],{16:function(e,t,n){},18:function(e,t,n){},20:function(e,t,n){},21:function(e,t,n){"use strict";n.r(t);var a=n(1),s=n.n(a),r=n(9),i=n.n(r),o=n(2),c=n(3),l=n(5),u=n(4),h=(n(16),n(11)),d=n(7),m=n.n(d),b=n(10),f=n(8),p=function(){function e(t,n){Object(o.a)(this,e),this.baseUrl="wss://stream.binance.com:9443/ws",this.tvIntervals={1:"1m",3:"3m",5:"5m",15:"15m",30:"30m",60:"1h",120:"2h",240:"4h",360:"6h",480:"8h",720:"12h",D:"1d","1D":"1d","3D":"3d",W:"1w","1W":"1w",M:"1M","1M":"1M"},this.streams={},this._createSocket()}return Object(c.a)(e,[{key:"_createSocket",value:function(){var e=this;this._ws=new WebSocket(this.baseUrl),this._ws.onopen=function(e){console.info("Binance WS Open"),localStorage.setItem("wsStatus",1)},this._ws.onclose=function(){console.warn("Binance WS Closed"),localStorage.setItem("wsStatus",0)},this._ws.onerror=function(e){console.warn("WS Error",e),localStorage.setItem("wsStatus",0)},this._ws.onmessage=function(t){if(null===t||void 0===t?void 0:t.data){var n=JSON.parse(t.data);try{if(n&&n.k){var a=n.s,s=(n.E,n.k),r=s.o,i=s.h,o=s.l,c=s.v,l=s.c,u=s.T,h=s.t,d={time:h,close:parseFloat(l),open:parseFloat(r),high:parseFloat(i),low:parseFloat(o),volume:parseFloat(c),closeTime:u,openTime:h};Object.keys(e.streams).length&&(e.streams[a].data=d,e.streams[a].listener(d))}}catch(m){console.error(m)}}}}},{key:"subscribeOnStream",value:function(e,t,n,a,s,r){try{var i="".concat(e.name.toLowerCase(),"@kline_").concat(this.tvIntervals[t]),o={method:"SUBSCRIBE",params:[i],id:1};1===this._ws.readyState&&(this._ws.send(JSON.stringify(o)),this.streams[e.name]={paramStr:i,listener:n})}catch(c){console.error(c)}}},{key:"unsubscribeFromStream",value:function(e){try{var t=e.split("_")[0],n={method:"UNSUBSCRIBE",params:[this.streams[t].paramStr],id:1};delete this.streams[t],1===this._ws.readyState&&this._ws.send(JSON.stringify(n))}catch(a){console.error(a)}}}]),e}(),v=function(){function e(t){Object(o.a)(this,e),this.binanceHost="https://api.binance.com",this.debug=t.debug||!1,this.ws=new p}return Object(c.a)(e,[{key:"binanceSymbols",value:function(){return fetch(this.binanceHost+"/api/v1/exchangeInfo").then((function(e){return e.json()})).then((function(e){return e.symbols}))}},{key:"binanceKlines",value:function(e,t,n,a,s){var r="".concat(this.binanceHost,"/api/v1/klines?symbol=").concat(e,"&interval=").concat(t).concat(n?"&startTime=".concat(n):"").concat(a?"&endTime=".concat(a):"").concat(s?"&limit=".concat(s):"");return fetch(r).then((function(e){return e.json()})).then((function(e){return e}))}},{key:"onReady",value:function(e){var t=this;this.binanceSymbols().then((function(n){t.symbols=n,e({supports_marks:!1,supports_timescale_marks:!1,supports_time:!0,supported_resolutions:["1","3","5","15","30","60","120","240","360","480","720","1D","3D","1W","1M"]})})).catch((function(e){console.error(e)}))}},{key:"searchSymbols",value:function(e,t,n,a){e=e.toUpperCase(),a(this.symbols.filter((function(t){return t.symbol.indexOf(e)>=0})).map((function(e){return{symbol:e.symbol,full_name:e.symbol,description:e.baseAsset+" / "+e.quoteAsset,ticker:e.symbol,exchange:"Binance",type:"crypto"}})))}},{key:"resolveSymbol",value:function(e,t,n){this.debug&&console.log("\ud83d\udc49 resolveSymbol:",e);var a=e.split(":");function s(e){var t,n=Object(f.a)(e.filters);try{for(n.s();!(t=n.n()).done;){var a=t.value;if("PRICE_FILTER"==a.filterType)return Math.round(1/parseFloat(a.tickSize))}}catch(s){n.e(s)}finally{n.f()}return 1}e=(a.length>1?a[1]:e).toUpperCase();var r,i=Object(f.a)(this.symbols);try{var o=function(){var n=r.value;if(n.symbol==e)return setTimeout((function(){t({name:n.symbol,description:n.baseAsset+" / "+n.quoteAsset,ticker:n.symbol,exchange:"Binance",listed_exchange:"Binance",type:"crypto",session:"24x7",minmov:1,pricescale:s(n),has_intraday:!0,has_daily:!0,has_weekly_and_monthly:!0,currency_code:n.quoteAsset})}),0),{v:void 0}};for(i.s();!(r=i.n()).done;){var c=o();if("object"===typeof c)return c.v}}catch(l){i.e(l)}finally{i.f()}n("not found")}},{key:"getBars",value:function(e,t,n,a,s,r,i){var o=this,c=this.ws.tvIntervals[t];c||r("Invalid interval");var l=[],u=function(){if(0===l.length)s([],{noData:!0});else{var e=l.map((function(e){return{time:e[0],open:parseFloat(e[1]),high:parseFloat(e[2]),low:parseFloat(e[3]),close:parseFloat(e[4]),volume:parseFloat(e[5])}}));s(e,{noData:!1})}},h=function(){var t=Object(b.a)(m.a.mark((function t(n,a){var s;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,o.binanceKlines(e.name,c,n,a,500);case 3:s=t.sent,l=l.concat(s),500===s.length?(n=s[s.length-1][0]+1,h(n,a)):u(),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(0),console.error(t.t0),r("Error in 'getKlines' func");case 12:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e,n){return t.apply(this,arguments)}}();h(n*=1e3,a*=1e3)}},{key:"subscribeBars",value:function(e,t,n,a,s){this.ws.subscribeOnStream(e,t,n,a,s)}},{key:"unsubscribeBars",value:function(e){this.ws.unsubscribeFromStream(e)}}]),e}(),y=(n(18),n(0)),g=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a,s=e.chartProperties;return Object(o.a)(this,n),(a=t.call(this)).chartReady=function(){a.tradingViewWidget&&a.tradingViewWidget.onChartReady((function(){a.chartObject=a.tradingViewWidget.activeChart()}))},a.state={isChartReady:!1},a.bfAPI=new v({debug:!1}),a.widgetOptions=Object(h.a)({container_id:"chart_container",datafeed:a.bfAPI,library_path:"/scripts/charting_library/",disabled_features:["timeframes_toolbar","header_undo_redo"]},s),a.tradingViewWidget=null,a.chartObject=null,a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.tradingViewWidget=window.tvWidget=new window.TradingView.widget(this.widgetOptions),this.chartReady()}},{key:"componentDidUpdate",value:function(){this.tradingViewWidget}},{key:"render",value:function(){return Object(y.jsx)("div",{id:"chart_container"})}}]),n}(a.Component);var w=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;return Object(o.a)(this,n),(e=t.call(this)).cOptions={locale:navigator.language.split("-")[0]||"en",debug:!1,fullscreen:!1,symbol:"BNBUSDT",interval:"60",theme:"dark",allow_symbol_change:!0,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,autosize:!0},e}return Object(c.a)(n,[{key:"render",value:function(){return Object(y.jsx)("div",{className:"container",children:Object(y.jsx)("div",{className:"trading-chart",children:Object(y.jsx)(g,{chartProperties:this.cOptions})})})}}]),n}(a.Component);n(20);i.a.render(Object(y.jsx)(s.a.StrictMode,{children:Object(y.jsx)(w,{})}),document.getElementById("root"))}},[[21,1,2]]]);
//# sourceMappingURL=main.cc2202c0.chunk.js.map